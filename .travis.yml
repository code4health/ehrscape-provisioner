language: node_js
node_js:
- '0.10'
before_script:
- export DISPLAY=:99.0
- sh -e /etc/init.d/xvfb start
- npm start > /dev/null &
- npm run update-webdriver
- sleep 1
script:
- node_modules/.bin/karma start karma.conf.js --no-auto-watch --single-run --reporters=dots
  --browsers=Firefox
- node_modules/.bin/protractor e2e-test/protractor.conf.js --browser=firefox
deploy:
  provider: openshift
  user: dave.thompson@across.co.uk
  password:
    secure: ud+IVrn1NRgbH4YRb24bAVpWgU0840NTSAuo6o+97+7PgYtjpKVpuDdYrPkGLzFGAQsxGgzgtamiTZxC9LeE152gPJNG2paxzViHTT2ELHuKgu4lEXZldMtmWOFXOsdU9YgSIpxtPkMyo3g/SIxn9dESbGJXPjzfsbLvsxh3I79QUZmTCwz5k8uENJOhWljAJGv+MEgSp3uv/JbvOKOSIojZrxtnG9VJr9ZetKs6YJpw+YCAGIZYTn7O+bdWcjbV4gzftLizrwNRCq7xJM42C4hrb1GzvhhnsHvYOCWvbGNQOGgOdmaIG0LH4xdS7hMsJ5uN4Ng0Uzpx5/+cisPeOLrweMz+bFM30vOufZCp0bmirPfRiRspiaGc37niockJIERHaeVUuBh7U189rQ2smJVxfc8/DotiPmLI938PuHkqN4bkCk03hBBzeMjSzT3CHG8/MrRSfYRYuzLLxTrh+g5fgZbEw+JWlISbQiI6C9G/zYX5XEHrPDFeerfFio98Sx8n1rdDap67N0FUhqbYxhH5ovUtfett5U0DqmU+zP3pelmUi4rKuuwPTeIWMdU5ySbpvMXvHzcYVUvBtqgENShr9apK60i0mMaolLd/WpF/lPVC2t5+YuBTMSdaeUF2i3SjqLaFwD9VmCMT1e7PShikWfg9ASvxUjiouBKeOGg=
  app: provisioner
  domain: handihopd
  on:
    repo: handihealth/ehrscape-provisioner
  skip_cleanup: true
